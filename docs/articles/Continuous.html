<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ToxicR: Continuous Analysis ‚Ä¢ ToxicR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="ToxicR: Continuous Analysis">
<meta property="og:description" content="ToxicR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ToxicR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">22.8.1.0.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Continuous.html">ToxicR: Continuous Analysis</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/NIEHS/ToxicR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>ToxicR: Continuous Analysis</h1>
                        <h4 data-toc-skip class="author">Matt Wheeler
Ph.D.</h4>
            
            <h4 data-toc-skip class="date">2/15/2022</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/NIEHS/ToxicR/blob/HEAD/vignettes/Continuous.Rmd" class="external-link"><code>vignettes/Continuous.Rmd</code></a></small>
      <div class="hidden name"><code>Continuous.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="basics-of-toxic-r-continuous-run-">Basics of Toxic R Continuous run.<a class="anchor" aria-label="anchor" href="#basics-of-toxic-r-continuous-run-"></a>
</h2>
<p>This file shows ToxicR for dichotomous benchmark dose analyses using
both single model and multiple model fits. The first thing we need to do
is load the data. From an excel file this can be done using the
following R commands:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cont_data</span>           <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,nrow<span class="op">=</span><span class="fl">5</span>,ncol<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cont_data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Dose"</span>,<span class="st">"Mean"</span>,<span class="st">"N"</span>,<span class="st">"SD"</span><span class="op">)</span></span>
<span><span class="va">cont_data</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">50</span>,<span class="fl">100</span>,<span class="fl">200</span>,<span class="fl">400</span><span class="op">)</span></span>
<span><span class="va">cont_data</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.26</span>,<span class="fl">5.76</span>,<span class="fl">7.13</span>,<span class="fl">9.24</span>,<span class="fl">9.23</span><span class="op">)</span></span>
<span><span class="va">cont_data</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">20</span>,<span class="fl">20</span>,<span class="fl">20</span>,<span class="fl">20</span><span class="op">)</span></span>
<span><span class="va">cont_data</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span><span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.23</span>,<span class="fl">1.47</span>,<span class="fl">2.47</span>,<span class="fl">2.24</span>,<span class="fl">1.56</span><span class="op">)</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">cont_data</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span></code></pre></div>
<div class="section level3">
<h3 id="hill-fit">Hill fit<a class="anchor" aria-label="anchor" href="#hill-fit"></a>
</h3>
<p>In what follows, I describe fitting the models using summary
statistics. One can also fit these models using the original data with
no change to the function call except the Y is a <span class="math inline">\(n\times 1\)</span> now one column vector, and the
dose vector is also <span class="math inline">\(n\times 1\)</span> and
corresponds to each entry in the data vector.</p>
<p>When summary data are used, ToxicR expects <span class="math inline">\(Y\)</span> to be a <span class="math inline">\(n\times 3\)</span> matrix. The first column of
<span class="math inline">\(Y\)</span> is the the mean, the second
colunn is the number of units on test, and the third column is the
observed standard deviation. In what follows, lets look at the Hill
model fit, where the Hill model is <span class="math display">\[\begin{align}
f(dose) &amp;= a + \frac{b\times dose}{c^d + [dose]^d}
\end{align}\]</span></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/NIEHS/ToxicR" class="external-link">ToxicR</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                                                                                             </span></span>
<span><span class="co">#&gt;   _______               _____  </span></span>
<span><span class="co">#&gt;  |__   __|      ü§ì     |  __ \ </span></span>
<span><span class="co">#&gt;     | | _____  ___  ___| |__) |</span></span>
<span><span class="co">#&gt;     | |/ _ \ \/ / |/ __|  _  / </span></span>
<span><span class="co">#&gt;     | | (_) &gt;  &lt;| | (__| | \ \ </span></span>
<span><span class="co">#&gt;     |_|\___/_/\_\_|\___|_|  \_\</span></span>
<span><span class="co">#&gt;                            22.8.1.0.4</span></span>
<span><span class="co">#&gt;     ___</span></span>
<span><span class="co">#&gt;     | |</span></span>
<span><span class="co">#&gt;     / \                   ____()()</span></span>
<span><span class="co">#&gt;    /‚ò†‚ò†‚ò†\                 /       xx</span></span>
<span><span class="co">#&gt;   (_____)          `~~~~~\_;m__m.__&gt;o   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                          </span></span>
<span><span class="co">#&gt; THE SOFTWARE IS PROVIDED AS IS, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, </span></span>
<span><span class="co">#&gt; INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A </span></span>
<span><span class="co">#&gt; PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT </span></span>
<span><span class="co">#&gt; HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF </span></span>
<span><span class="co">#&gt; CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE</span></span>
<span><span class="co">#&gt; OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">hill_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/single_continuous_fit.html">single_continuous_fit</a></span><span class="op">(</span><span class="va">cont_data</span><span class="op">[</span>,<span class="st">"Dose"</span><span class="op">]</span>,<span class="va">Y</span>,</span>
<span>                                  model_type<span class="op">=</span><span class="st">"hill"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="object-extraction">Object Extraction<a class="anchor" aria-label="anchor" href="#object-extraction"></a>
</h3>
<p>The last line fits the Hill Bayesian Laplace model and puts all of
the information one needs in the `hill_fit‚Äô object variable. This
variable has the same structure as its dichotomous counterpart. By
default the procedure assumes normal variance proportional to the mean.
To see what model you fit, simply type the following line:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hill_fit</span><span class="op">$</span><span class="va">full_model</span></span>
<span><span class="co">#&gt; [1] "Model: Hill Distribution: Normal-NCV"</span></span>
<span><span class="va">hill_fit</span><span class="op">$</span><span class="va">prior</span></span>
<span><span class="co">#&gt; $priors</span></span>
<span><span class="co">#&gt;      [,1]      [,2]      [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,]    1 1.0000000 1.0000000 -100  100</span></span>
<span><span class="co">#&gt; [2,]    1 0.0000000 1.0000000 -100  100</span></span>
<span><span class="co">#&gt; [3,]    2 0.0000000 2.0000000    0  100</span></span>
<span><span class="co">#&gt; [4,]    2 0.4700036 0.4214036    0   18</span></span>
<span><span class="co">#&gt; [5,]    2 0.0000000 1.0000000    0  100</span></span>
<span><span class="co">#&gt; [6,]    1 0.8349247 1.0000000  -18   18</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $model</span></span>
<span><span class="co">#&gt; [1] "Hill Model [normal-ncv]"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $parameters</span></span>
<span><span class="co">#&gt; [1] "a"            "b"            "c"            "d"            "rho"         </span></span>
<span><span class="co">#&gt; [6] "log(sigma^2)"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt; [1] "hill"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "BMD_Bayes_continuous_model"</span></span></code></pre></div>
<p>Here, we see the Hill model is fit using the Normal-NCV, or normal
variance proportional to the mean. For the Hill model, you can also use
‚Äònormal‚Äô as a distribution option.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hill_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/single_continuous_fit.html">single_continuous_fit</a></span><span class="op">(</span><span class="va">cont_data</span><span class="op">[</span>,<span class="st">"Dose"</span><span class="op">]</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">cont_data</span><span class="op">[</span>,<span class="st">"Mean"</span><span class="op">]</span>,<span class="va">cont_data</span><span class="op">[</span>,<span class="st">"N"</span><span class="op">]</span>,<span class="va">cont_data</span><span class="op">[</span>,<span class="st">"SD"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                                  model_type<span class="op">=</span><span class="st">"hill"</span>,distribution <span class="op">=</span> <span class="st">"normal"</span>,</span>
<span>                                  fit_type <span class="op">=</span> <span class="st">"mcmc"</span><span class="op">)</span></span>
<span><span class="va">hill_fit</span><span class="op">$</span><span class="va">full_model</span></span>
<span><span class="co">#&gt; [1] "Model: Hill Distribution: Normal"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">hill_fit</span><span class="op">)</span></span></code></pre></div>
<p><img src="Continuous_files/figure-html/run_laplace_hill3-1.png" width="576"></p>
<p>Notice how the `distribution‚Äô option controls the distribution. For
the ‚Äúhill‚Äù, ‚Äúpower‚Äù, and ‚Äúpolynomial‚Äù DR models you can choose either
‚Äúnormal‚Äù or ‚Äúnormal-ncv.‚Äù or the ‚Äúexp-3‚Äù and ‚Äúexp-5‚Äù models you can also
choose ‚Äúlognormal.‚Äù</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exp5_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/single_continuous_fit.html">single_continuous_fit</a></span><span class="op">(</span><span class="va">cont_data</span><span class="op">[</span>,<span class="st">"Dose"</span><span class="op">]</span>,<span class="va">Y</span>,</span>
<span>                                  model_type<span class="op">=</span><span class="st">"exp-5"</span>,distribution <span class="op">=</span> <span class="st">"lognormal"</span>,fit_type<span class="op">=</span><span class="st">"laplace"</span><span class="op">)</span></span>
<span><span class="va">exp5_fit</span><span class="op">$</span><span class="va">full_model</span></span>
<span><span class="co">#&gt; [1] "Model: Exponential-5 Distribution: Log-Normal"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">exp5_fit</span><span class="op">)</span></span></code></pre></div>
<p><img src="Continuous_files/figure-html/run_laplace_exp5-1.png" width="576"></p>
</div>
</div>
<div class="section level2">
<h2 id="benchmark-dose-types">Benchmark Dose Types<a class="anchor" aria-label="anchor" href="#benchmark-dose-types"></a>
</h2>
<div class="section level3">
<h3 id="absolute-deviation">Absolute Deviation<a class="anchor" aria-label="anchor" href="#absolute-deviation"></a>
</h3>
<p>There are also other types of BMDs you can choose. Here one can
specify absolute deviation as ‚Äòabs,‚Äô which solves <span class="math display">\[\begin{align}
\mid f(\mbox{BMD}) - f(0) \mid = \mbox{BMR},
\end{align}\]</span> where <span class="math inline">\(BMR\)</span> is a
specific cutoff value. In the example below, the abosolute difference of
<span class="math inline">\(\mbox{BMR} = 2.\)</span></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hill_sd_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/single_continuous_fit.html">single_continuous_fit</a></span><span class="op">(</span><span class="va">cont_data</span><span class="op">[</span>,<span class="st">"Dose"</span><span class="op">]</span>,<span class="va">Y</span>,</span>
<span>                                  model_type<span class="op">=</span><span class="st">"hill"</span>,distribution <span class="op">=</span> <span class="st">"normal-ncv"</span>, fit_type<span class="op">=</span><span class="st">"mcmc"</span>,</span>
<span>                                  BMD_TYPE<span class="op">=</span><span class="st">"abs"</span>,BMR <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">hill_sd_fit</span><span class="op">$</span><span class="va">full_model</span></span>
<span><span class="co">#&gt; [1] "Model: Hill Distribution: Normal-NCV"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">hill_sd_fit</span><span class="op">)</span></span></code></pre></div>
<p><img src="Continuous_files/figure-html/run_laplace_hillad-1.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="standard-deviation">Standard Deviation<a class="anchor" aria-label="anchor" href="#standard-deviation"></a>
</h3>
<p>The standard deviation approach is the default approach, and this is
the value that solves <span class="math display">\[\begin{align}
\mid f(\mbox{BMD}) - f(0) \mid = \mbox{BMR} \sigma_0,
\end{align}\]</span> and in this definition the <span class="math inline">\(BMR \geq 0\)</span> is the number of standard
deviations the mean changes from no-exposure. In the example below, the
<span class="math inline">\(\mbox{BMR} = 1.5.\)</span></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hill_sd_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/single_continuous_fit.html">single_continuous_fit</a></span><span class="op">(</span><span class="va">cont_data</span><span class="op">[</span>,<span class="st">"Dose"</span><span class="op">]</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">cont_data</span><span class="op">[</span>,<span class="st">"Mean"</span><span class="op">]</span>,<span class="va">cont_data</span><span class="op">[</span>,<span class="st">"N"</span><span class="op">]</span>,<span class="va">cont_data</span><span class="op">[</span>,<span class="st">"SD"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                                  model_type<span class="op">=</span><span class="st">"hill"</span>,distribution <span class="op">=</span> <span class="st">"normal-ncv"</span>,fit_type<span class="op">=</span><span class="st">"laplace"</span>,</span>
<span>                                  BMD_TYPE<span class="op">=</span><span class="st">"sd"</span>,BMR <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="va">hill_sd_fit</span><span class="op">$</span><span class="va">full_model</span></span>
<span><span class="co">#&gt; [1] "Model: Hill Distribution: Normal-NCV"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">hill_sd_fit</span><span class="op">)</span></span></code></pre></div>
<p><img src="Continuous_files/figure-html/run_laplace_hillsd-1.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="hybrid-deviation">Hybrid Deviation<a class="anchor" aria-label="anchor" href="#hybrid-deviation"></a>
</h3>
<p>The hybrid approach is a probabilistic approach that mimics risk for
dichotomous data. Here, the BMD is the value that solves <span class="math display">\[\begin{align}
\frac{ Pr[y &lt; Y_0 \mid \mbox{BMD}] - Pr[y &gt; Y_0 \mid 0]}{1-Pr[y
&gt; Y_0 \mid 0]}  = \mbox{BMR} .
\end{align}\]</span> Here, <span class="math inline">\(Pr[y &gt; Y_0
\mid 0]\)</span> is the probability that an ‚Äòadverse‚Äô response is
observed at background dose, and <span class="math inline">\(0 &lt;
\mbox{BMR} &lt; 1\)</span> is the increase in probability of seeing an
adverse response at dose <span class="math inline">\(\mbox{BMD}\)</span>. For this approach <span class="math inline">\(Pr[y &lt; Y_0 \mid 0]\)</span> must be specified
using the ‚Äúpoint_p‚Äù option. This option is only used when ‚Äúhybrid‚Äù is
specified. The following shows a Hill fit, where the BMD with only a
<span class="math inline">\(2.5\%\)</span> chance of being observed at
no dose, but has a <span class="math inline">\(12.25\%\)</span>
probability of being observed at dose <span class="math inline">\(\mbox{BMD}.\)</span> Note: <span class="math inline">\(\frac{0.1225 - 0.025}{0.975} = 0.1.\)</span> For
more information on this approach see Crump <span class="citation">[@crump1995calculation]</span>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hill_hybrid_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/single_continuous_fit.html">single_continuous_fit</a></span><span class="op">(</span><span class="va">cont_data</span><span class="op">[</span>,<span class="st">"Dose"</span><span class="op">]</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">cont_data</span><span class="op">[</span>,<span class="st">"Mean"</span><span class="op">]</span>,<span class="va">cont_data</span><span class="op">[</span>,<span class="st">"N"</span><span class="op">]</span>,<span class="va">cont_data</span><span class="op">[</span>,<span class="st">"SD"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                                  model_type<span class="op">=</span><span class="st">"hill"</span>,distribution <span class="op">=</span> <span class="st">"normal-ncv"</span>,fit_type<span class="op">=</span><span class="st">"mcmc"</span>,</span>
<span>                                  BMD_TYPE<span class="op">=</span><span class="st">"hybrid"</span>,point_p <span class="op">=</span> <span class="fl">0.025</span>,BMR <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">hill_hybrid_fit</span><span class="op">$</span><span class="va">full_model</span></span>
<span><span class="co">#&gt; [1] "Model: Hill Distribution: Normal-NCV"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">hill_hybrid_fit</span><span class="op">)</span></span></code></pre></div>
<p><img src="Continuous_files/figure-html/run_laplace_hillhybrid-1.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="relative-deviation">Relative Deviation<a class="anchor" aria-label="anchor" href="#relative-deviation"></a>
</h3>
<p>The relatived deviation approach <span class="citation">[@slob2002dose]</span> is the value that solves <span class="math display">\[\begin{align}
\mid f(\mbox{BMD}) - f(0) \mid = [1 + \mbox{BMR}] \times f(0),
\end{align}\]</span></p>
<p>where <span class="math inline">\(\mbox{BMR} &gt; 0\)</span> is the
value of increase/decrease from the background.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hill_rd_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/single_continuous_fit.html">single_continuous_fit</a></span><span class="op">(</span><span class="va">cont_data</span><span class="op">[</span>,<span class="st">"Dose"</span><span class="op">]</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">cont_data</span><span class="op">[</span>,<span class="st">"Mean"</span><span class="op">]</span>,<span class="va">cont_data</span><span class="op">[</span>,<span class="st">"N"</span><span class="op">]</span>,<span class="va">cont_data</span><span class="op">[</span>,<span class="st">"SD"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                                  model_type<span class="op">=</span><span class="st">"hill"</span>,distribution <span class="op">=</span> <span class="st">"normal-ncv"</span>, fit_type<span class="op">=</span><span class="st">"mcmc"</span>,</span>
<span>                                  BMD_TYPE<span class="op">=</span><span class="st">"rel"</span>,BMR <span class="op">=</span> <span class="fl">0.1</span>,samples <span class="op">=</span> <span class="fl">50000</span><span class="op">)</span></span>
<span><span class="va">hill_rd_fit</span><span class="op">$</span><span class="va">full_model</span></span>
<span><span class="co">#&gt; [1] "Model: Hill Distribution: Normal-NCV"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">hill_rd_fit</span><span class="op">)</span></span></code></pre></div>
<p><img src="Continuous_files/figure-html/run_laplace_hillrd-1.png" width="576">
Note: The above definitions are for for increasing data, `ToxicR‚Äô will
determine the direction of adversity and adjust computations
accordingly.</p>
</div>
</div>
<div class="section level2">
<h2 id="prior-specification">Prior Specification<a class="anchor" aria-label="anchor" href="#prior-specification"></a>
</h2>
<p>Like the dichotomous case you can modify the priors, to see what
prior you want to modify Again, this is easy we can type the following
code to see what our current prior is:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hill_sd_fit</span><span class="op">$</span><span class="va">prior</span></span>
<span><span class="co">#&gt; $priors</span></span>
<span><span class="co">#&gt;      [,1]      [,2]      [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,]    1 1.0000000 1.0000000 -100  100</span></span>
<span><span class="co">#&gt; [2,]    1 0.0000000 1.0000000 -100  100</span></span>
<span><span class="co">#&gt; [3,]    2 0.0000000 2.0000000    0  100</span></span>
<span><span class="co">#&gt; [4,]    2 0.4700036 0.4214036    0   18</span></span>
<span><span class="co">#&gt; [5,]    2 0.0000000 1.0000000    0  100</span></span>
<span><span class="co">#&gt; [6,]    1 0.8349247 1.0000000  -18   18</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $model</span></span>
<span><span class="co">#&gt; [1] "Hill Model [normal-ncv]"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $parameters</span></span>
<span><span class="co">#&gt; [1] "a"            "b"            "c"            "d"            "rho"         </span></span>
<span><span class="co">#&gt; [6] "log(sigma^2)"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt; [1] "hill"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "BMD_Bayes_continuous_model"</span></span>
<span></span>
<span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_prior_list.html">create_prior_list</a></span><span class="op">(</span><span class="fu"><a href="../reference/normprior.html">normprior</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="op">-</span><span class="fl">100</span>,<span class="fl">100</span><span class="op">)</span>,</span>
<span>                           <span class="fu"><a href="../reference/normprior.html">normprior</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="op">-</span><span class="fl">1e4</span>,<span class="fl">1e4</span><span class="op">)</span>,</span>
<span>                           <span class="fu"><a href="../reference/lnormprior.html">lnormprior</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>,</span>
<span>                           <span class="fu"><a href="../reference/lnormprior.html">lnormprior</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,<span class="fl">0.4215</span>,<span class="fl">0</span>,<span class="fl">18</span><span class="op">)</span>,</span>
<span>                           <span class="fu"><a href="../reference/lnormprior.html">lnormprior</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">100</span><span class="op">)</span>,</span>
<span>                           <span class="fu"><a href="../reference/normprior.html">normprior</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>,<span class="op">-</span><span class="fl">100</span>,<span class="fl">100</span><span class="op">)</span><span class="op">)</span>;</span>
<span></span>
<span><span class="va">p_hill_ncv</span> <span class="op">=</span> <span class="fu"><a href="../reference/create_continuous_prior.html">create_continuous_prior</a></span><span class="op">(</span><span class="va">prior</span>,<span class="st">"hill"</span>,<span class="st">"normal-ncv"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_prior_list.html">create_prior_list</a></span><span class="op">(</span><span class="fu"><a href="../reference/normprior.html">normprior</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="op">-</span><span class="fl">100</span>,<span class="fl">100</span><span class="op">)</span>,</span>
<span>                           <span class="fu"><a href="../reference/normprior.html">normprior</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="op">-</span><span class="fl">1e4</span>,<span class="fl">1e4</span><span class="op">)</span>,</span>
<span>                           <span class="fu"><a href="../reference/lnormprior.html">lnormprior</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>,</span>
<span>                           <span class="fu"><a href="../reference/lnormprior.html">lnormprior</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,<span class="fl">0.4215</span>,<span class="fl">0</span>,<span class="fl">18</span><span class="op">)</span>,</span>
<span>                           <span class="fu"><a href="../reference/normprior.html">normprior</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>,<span class="op">-</span><span class="fl">100</span>,<span class="fl">100</span><span class="op">)</span><span class="op">)</span>;</span>
<span></span>
<span><span class="va">p_hill_norm</span> <span class="op">=</span> <span class="fu"><a href="../reference/create_continuous_prior.html">create_continuous_prior</a></span><span class="op">(</span><span class="va">prior</span>,<span class="st">"hill"</span>,<span class="st">"normal"</span><span class="op">)</span></span></code></pre></div>
<p>When specifying a prior, it is slightly different than the
dichotomous case. Here, we need to specify what distribution we are
using too. This adds one or two parameters depending on the parameters.
All models have a parameter called <span class="math inline">\(\log(\sigma^2),\)</span> which is the variance
term, and it is ALWAYS the last parameter in the model, and the<br>
prior is placed over the log of this value. For the ‚Äònormal-NCV‚Äô option,
the variance is <span class="math inline">\(\sigma^2
f(dose)^\rho,\)</span> i.e., it has an additional parameter <span class="math inline">\(\rho.\)</span> The parameter <span class="math inline">\(\rho\)</span> must have a prior, which is <span class="math inline">\(\mbox{log-Normal}(0,1)\)</span> in the above
code.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">hill_sd_a_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/single_continuous_fit.html">single_continuous_fit</a></span><span class="op">(</span><span class="va">cont_data</span><span class="op">[</span>,<span class="st">"Dose"</span><span class="op">]</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">cont_data</span><span class="op">[</span>,<span class="st">"Mean"</span><span class="op">]</span>,<span class="va">cont_data</span><span class="op">[</span>,<span class="st">"N"</span><span class="op">]</span>,<span class="va">cont_data</span><span class="op">[</span>,<span class="st">"SD"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                                  prior<span class="op">=</span><span class="va">p_hill_ncv</span>,</span>
<span>                                  fit_type<span class="op">=</span><span class="st">"laplace"</span>,</span>
<span>                                  BMD_TYPE<span class="op">=</span><span class="st">"sd"</span>,BMR <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">hill_sd_b_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/single_continuous_fit.html">single_continuous_fit</a></span><span class="op">(</span><span class="va">cont_data</span><span class="op">[</span>,<span class="st">"Dose"</span><span class="op">]</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">cont_data</span><span class="op">[</span>,<span class="st">"Mean"</span><span class="op">]</span>,<span class="va">cont_data</span><span class="op">[</span>,<span class="st">"N"</span><span class="op">]</span>,<span class="va">cont_data</span><span class="op">[</span>,<span class="st">"SD"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                                  prior<span class="op">=</span><span class="va">p_hill_norm</span>,</span>
<span>                                  fit_type<span class="op">=</span><span class="st">"laplace"</span>,</span>
<span>                                  BMD_TYPE<span class="op">=</span><span class="st">"sd"</span>,BMR <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/" class="external-link">ggpubr</a></span><span class="op">)</span></span>
<span><span class="va">figure</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html" class="external-link">ggarrange</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">hill_sd_a_fit</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span>, </span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">hill_sd_b_fit</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span>,</span>
<span>                    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Prior NCV"</span>, <span class="st">"Prior Normal"</span><span class="op">)</span>,</span>
<span>                    ncol <span class="op">=</span> <span class="fl">1</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">figure</span></span></code></pre></div>
<p><img src="Continuous_files/figure-html/run_laplace_cprior2-1.png" width="576"></p>
<p>In the above code, we didn‚Äôt need to specify the ‚Äòmodel_type‚Äô or
‚Äòdistribution‚Äô because this is done implicitly when you specify the
prior. The above code works for the hill model, lets try it for a
polynomial model.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="va">poly_sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/single_continuous_fit.html">single_continuous_fit</a></span><span class="op">(</span><span class="va">cont_data</span><span class="op">[</span>,<span class="st">"Dose"</span><span class="op">]</span>,<span class="va">Y</span>,</span>
<span>                                  distribution<span class="op">=</span><span class="st">"normal"</span>,model_type<span class="op">=</span><span class="st">"polynomial"</span>,</span>
<span>                                  degree <span class="op">=</span> <span class="fl">4</span>, </span>
<span>                                  fit_type<span class="op">=</span><span class="st">"laplace"</span>,</span>
<span>                                  BMD_TYPE<span class="op">=</span><span class="st">"sd"</span>,BMR <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co">#&gt; WARNING: Polynomial models may provide unstable estimates because of possible non-monotone behavior.</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">poly_sd</span><span class="op">)</span></span></code></pre></div>
<p><img src="Continuous_files/figure-html/run_laplace_polynomial-1.png" width="576"></p>
</div>
<div class="section level2">
<h2 id="model-averaging">Model Averaging<a class="anchor" aria-label="anchor" href="#model-averaging"></a>
</h2>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_prior_list.html">create_prior_list</a></span><span class="op">(</span><span class="fu"><a href="../reference/normprior.html">normprior</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="op">-</span><span class="fl">100</span>,<span class="fl">100</span><span class="op">)</span>,</span>
<span>                           <span class="fu"><a href="../reference/normprior.html">normprior</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="op">-</span><span class="fl">1e4</span>,<span class="fl">1e4</span><span class="op">)</span>,</span>
<span>                           <span class="fu"><a href="../reference/lnormprior.html">lnormprior</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>,</span>
<span>                           <span class="fu"><a href="../reference/lnormprior.html">lnormprior</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,<span class="fl">0.4215</span>,<span class="fl">0</span>,<span class="fl">18</span><span class="op">)</span>,</span>
<span>                           <span class="fu"><a href="../reference/lnormprior.html">lnormprior</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">100</span><span class="op">)</span>,</span>
<span>                           <span class="fu"><a href="../reference/normprior.html">normprior</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>,<span class="op">-</span><span class="fl">100</span>,<span class="fl">100</span><span class="op">)</span><span class="op">)</span>;</span>
<span></span>
<span><span class="va">p_hill_ncv</span> <span class="op">=</span> <span class="fu"><a href="../reference/create_continuous_prior.html">create_continuous_prior</a></span><span class="op">(</span><span class="va">prior</span>,<span class="st">"hill"</span>,<span class="st">"normal-ncv"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_prior_list.html">create_prior_list</a></span><span class="op">(</span><span class="fu"><a href="../reference/normprior.html">normprior</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="op">-</span><span class="fl">100</span>,<span class="fl">100</span><span class="op">)</span>,</span>
<span>                           <span class="fu"><a href="../reference/normprior.html">normprior</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="op">-</span><span class="fl">1e4</span>,<span class="fl">1e4</span><span class="op">)</span>,</span>
<span>                           <span class="fu"><a href="../reference/lnormprior.html">lnormprior</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>,</span>
<span>                           <span class="fu"><a href="../reference/lnormprior.html">lnormprior</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,<span class="fl">0.4215</span>,<span class="fl">0</span>,<span class="fl">18</span><span class="op">)</span>,</span>
<span>                           <span class="fu"><a href="../reference/normprior.html">normprior</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>,<span class="op">-</span><span class="fl">100</span>,<span class="fl">100</span><span class="op">)</span><span class="op">)</span>;</span>
<span></span>
<span><span class="va">p_hill_norm</span> <span class="op">=</span> <span class="fu"><a href="../reference/create_continuous_prior.html">create_continuous_prior</a></span><span class="op">(</span><span class="va">prior</span>,<span class="st">"hill"</span>,<span class="st">"normal"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_prior_list.html">create_prior_list</a></span><span class="op">(</span><span class="fu"><a href="../reference/normprior.html">normprior</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="op">-</span><span class="fl">100</span>,<span class="fl">100</span><span class="op">)</span>,</span>
<span>                           <span class="fu"><a href="../reference/normprior.html">normprior</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="op">-</span><span class="fl">1e4</span>,<span class="fl">1e4</span><span class="op">)</span>,</span>
<span>                           <span class="fu"><a href="../reference/lnormprior.html">lnormprior</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>,</span>
<span>                           <span class="fu"><a href="../reference/lnormprior.html">lnormprior</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,<span class="fl">0.4215</span>,<span class="fl">0</span>,<span class="fl">18</span><span class="op">)</span>,</span>
<span>                           <span class="fu"><a href="../reference/normprior.html">normprior</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>,<span class="op">-</span><span class="fl">100</span>,<span class="fl">100</span><span class="op">)</span><span class="op">)</span>;</span>
<span></span>
<span><span class="va">p_exp5_norm</span> <span class="op">=</span> <span class="fu"><a href="../reference/create_continuous_prior.html">create_continuous_prior</a></span><span class="op">(</span><span class="va">prior</span>,<span class="st">"exp-5"</span>,<span class="st">"normal"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_prior_list.html">create_prior_list</a></span><span class="op">(</span><span class="fu"><a href="../reference/normprior.html">normprior</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="op">-</span><span class="fl">100</span>,<span class="fl">100</span><span class="op">)</span>,</span>
<span>                           <span class="fu"><a href="../reference/normprior.html">normprior</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="op">-</span><span class="fl">1e4</span>,<span class="fl">1e4</span><span class="op">)</span>,</span>
<span>                           <span class="fu"><a href="../reference/lnormprior.html">lnormprior</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,<span class="fl">0.4215</span>,<span class="fl">0</span>,<span class="fl">18</span><span class="op">)</span>,</span>
<span>                           <span class="fu"><a href="../reference/normprior.html">normprior</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>,<span class="op">-</span><span class="fl">100</span>,<span class="fl">100</span><span class="op">)</span><span class="op">)</span>;</span>
<span><span class="va">p_power_norm</span> <span class="op">=</span> <span class="fu"><a href="../reference/create_continuous_prior.html">create_continuous_prior</a></span><span class="op">(</span><span class="va">prior</span>,<span class="st">"power"</span>,<span class="st">"normal"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_prior_list.html">create_prior_list</a></span><span class="op">(</span><span class="fu"><a href="../reference/normprior.html">normprior</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="op">-</span><span class="fl">100</span>,<span class="fl">100</span><span class="op">)</span>,</span>
<span>                           <span class="fu"><a href="../reference/normprior.html">normprior</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="op">-</span><span class="fl">1e4</span>,<span class="fl">1e4</span><span class="op">)</span>,</span>
<span>                           <span class="fu"><a href="../reference/lnormprior.html">lnormprior</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,<span class="fl">0.4215</span>,<span class="fl">0</span>,<span class="fl">18</span><span class="op">)</span>,</span>
<span>                           <span class="fu"><a href="../reference/normprior.html">normprior</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>,<span class="op">-</span><span class="fl">100</span>,<span class="fl">100</span><span class="op">)</span><span class="op">)</span>;</span>
<span><span class="va">p_exp3_norm</span> <span class="op">=</span> <span class="fu"><a href="../reference/create_continuous_prior.html">create_continuous_prior</a></span><span class="op">(</span><span class="va">prior</span>,<span class="st">"exp-3"</span>,<span class="st">"normal"</span><span class="op">)</span></span>
<span><span class="co">#&gt; NOTE: Parameter 'c' added to prior list. It is not used in the analysis.</span></span>
<span><span class="va">prior_list</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">p_exp3_norm</span>,<span class="va">p_hill_norm</span>,<span class="va">p_exp5_norm</span>,<span class="va">p_power_norm</span><span class="op">)</span></span></code></pre></div>
<p>With a list of priors one can then run a model average based upon a
user specified model space. Here, all of the same benchmark dose options
of ‚Äòsingle_continuous_fit‚Äô apply.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ma_sd_mcmc_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ma_continuous_fit.html">ma_continuous_fit</a></span><span class="op">(</span><span class="va">cont_data</span><span class="op">[</span>,<span class="st">"Dose"</span><span class="op">]</span>,<span class="va">Y</span>, fit_type<span class="op">=</span> <span class="st">"laplace"</span>,</span>
<span>                             BMD_TYPE<span class="op">=</span><span class="st">"sd"</span>,BMR <span class="op">=</span> <span class="fl">0.5</span>,samples <span class="op">=</span> <span class="fl">50000</span>,model_list<span class="op">=</span><span class="va">prior_list</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ma_sd_mcmc_2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Scale for 'x' is already present. Adding another scale for 'x', which will</span></span>
<span><span class="co">#&gt; replace the existing scale.</span></span></code></pre></div>
<p><img src="Continuous_files/figure-html/run_laplace_MA_3-1.png" width="576"></p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Wout Slob, Dose-Response Modeling of Continuous Endpoints,
Toxicological Sciences, Volume 66, Issue 2, April 2002, Pages
298‚Äì312</p>
<p>Crump, Kenny S., Calculation of benchmark doses from continuous data,
Risk Analysis, Volume 15, Issue 1, February 1995, Pages 79-89</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Matt Wheeler, Sooyeong Lim.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
